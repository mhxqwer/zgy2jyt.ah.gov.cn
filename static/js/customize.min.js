
var pageGlobal = function () {

    // 首页模板
    var indexListTpl = Ls.compile(
        '<?' +
        'var css = "";' +
        'for (var i=0; i<result.length; i++) {' +
        '   var el = result[i];' +
        '   css = "odd";' +
        '   if (i % 2 == 1) {' +
        '       css = "even";' +
        '   }' +
        '   var year = el.xfsj.substr(0,4),' +
        '       month = el.xfsj.substr(4,2),' +
        '       day = el.xfsj.substr(6,2);' +
        '?>' +
        '    <li class="<?=css?>">' +
        '        <p class="p4"><?=year+"-"+month+"-"+day?></p>' +
        '        <p class="p3"><?=el.mtztmc?></p>' +
        '        <p class="p1">' +
        '            <a href="/site/tpl/4301?xtype=replyDetail&menuFlag=3&lsbh=<?=el.lsbh?>=&xfjbh=<?=el.xfjbh?>" title="<?=el.lxbt?>" target="_blank">' +
        '                <?=el.lxbt?>' +
        '            </a>' +
        '        </p>' +
        '    </li>' +
        '<? } ?>'
    );

    var service = function (options) {
        var me = this;
        me.options = $.extend(true, {
            columnId: 31416308
        }, options)
        me.$select = $('#year_fw_select');
    }

    service.prototype.bindEvent = function () {
        var me = this;
        me.$select.on('change', function (e) {
            var val = $(this).val();
            $(".m-dtbox").load('/content/article/' + val + ' .j-fontContent>*');
        }).trigger('change');
    }

    // 获取option
    service.prototype.getSelectOption = function () {
        var me = this,
            columnId = me.options.columnId;
        if (columnId == 31416307) {
            columnId = 31416308
            $('.m-dtserlf').find('li:first').addClass('active');
        }
        return Ls.ajax({
            url: '/site/label/8888',
            dataType: 'HTML',
            data: {
                labelName: 'articleNewsPageList',
                file: 'ahjyt/articleNewsPageList_sjfw',
                siteId: '6788021',
                id: columnId,
                pageSize: "33",
                length: "48",
                isDate: "true",
                dateFormat: "yyyy-MM-dd"
            }
        }).done(function (res) {
            if (res) {
                $('#year_fw_select').empty().append(res);
            }
        })
    }

    // 添加页初始化
    service.prototype.init = function () {
        var me = this;
        me.getSelectOption().done(function () {
            me.bindEvent();
        });
        return me;
    }

    $(function () {

    });

    return {
        service: service
    }
}();
